<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Analysis App</title>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <h1>Product Sales Analyzer</h1>
        <button id="homeBtn">Home</button>
    </header>

    <main>
        <section class="card upload-section">
            <h2>1. Upload Data</h2>
            <input type="file" id="fileInput" accept=".xlsx, .xls" multiple>
            <p id="fileInfo">No file selected</p>
        </section>

        <section class="card column-mapping" id="columnMapping" style="display: none;">
            <h2>2. Map Columns</h2>
            <div id="mappingFields">
                </div>
            <button id="confirmMappingBtn">Confirm Mapping</button>
        </section>

        <section class="card analysis-section">
            <h2>3. Run Analysis</h2>
            <div class="input-group">
                <label for="analysisType">Analysis Type:</label>
                <select id="analysisType">
                    <option value="">-- Select Analysis --</option>
                    <option value="fastMoving">Fast-Moving Products</option>
                    <option value="slowMoving">Slow-Moving Products</option>
                    <option value="contribution">Sales Contribution</option>
                    <option value="profitability">Profitability Analysis</option>
                </select>
            </div>
            <div id="analysisParams">
                </div>
            <button id="runAnalysisBtn">Run Analysis</button>
        </section>

        <section class="card visualization-section">
            <h2>4. Visualize & Export</h2>
            <div class="tab-buttons">
                <button class="tab-btn active" data-tab="tableResults">Table Results</button>
                <button class="tab-btn" data-tab="chartResults">Chart Visualization</button>
            </div>

            <div id="tableResults" class="results-section active">
                <h3>Analysis Report</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Quantity</th>
                                <th>Total Sales</th>
                                <th>Avg. Unit Price</th>
                                <th>Avg. Unit Cost</th>
                                <th>Profit / Contribution</th>
                            </tr>
                        </thead>
                        <tbody id="resultsTable">
                            </tbody>
                    </table>
                </div>
                <div class="export-actions">
                    <button id="exportBtn" class="export-btn"><i class="fas fa-file-excel"></i> Export Excel</button>
                    </div>
            </div>

            <div id="chartResults" class="results-section">
                <h3>Chart Visualization</h3>
                <div class="input-group">
                    <label for="chartType">Chart Type:</label>
                    <select id="chartType">
                        <option value="">-- Select Chart Type --</option>
                        <option value="bar">Bar Chart</option>
                        <option value="pie">Pie Chart</option>
                        <option value="doughnut">Doughnut Chart</option>
                    </select>
                    <button id="generateChartBtn">Generate Chart</button>
                </div>
                <div class="chart-container">
                    <canvas id="chartCanvas"></canvas>
                </div>
                <div class="chart-actions">
                    <button id="exportChartBtn" class="export-btn"><i class="fas fa-image"></i> Export Chart (PNG)</button>
                    </div>
            </div>
        </section>

        <div id="messageArea" class="message-area" style="display: none;">
            </div>

        <button id="resetBtn" class="reset-btn"><i class="fas fa-redo"></i> Reset Application</button>
    </main>

    <script src="script.js"></script>

</body>
</html>
